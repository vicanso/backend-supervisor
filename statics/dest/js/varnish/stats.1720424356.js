!function(t){"use strict";var n=function(t,n,a,e,r,s,c){function i(){var t=d.statsConfig;return t.interval?(o(f),void(d.init=!0)):(t.error="时间间隔不能为空",void(t.status="error"))}function u(){var t=c.quotaList(),n="uptime sess_conn sess_drop sess_fail client_req cache_hit cache_hitpass cache_miss backend_conn backend_unhealthy backend_busy backend_fail backend_reuse backend_toolate backend_recycle backend_retry fetch_length fetch_chunked fetch_failed n_lru_nuked n_lru_moved backend_req",a=[];return angular.forEach(t,function(t){var e=!1;-1!==n.indexOf(t)&&(e=!0),a.push({name:t,checked:e})}),a}function o(t){var n=1e3*d.statsConfig.interval;c.statsList(t).then(function(a){angular.forEach(a,function(n,a){var e=n.data,r=t[a].name,s=l[r];s||(s=[],l[r]=s),e&&s.push(e),s.length>11&&s.shift()}),d.statsList=h(l,[1,2,5,10]),r(function(){o(t)},n)},function(){r(function(){o(t)},n)})}function h(t,n){var a=[],e={};return angular.forEach(d.quotaList,function(t){t.checked&&(e[t.name]=!0)}),angular.forEach(t,function(t,r){var s=[],c=t[t.length-1],i={name:r,createdAt:c.createdAt,stats:s};angular.forEach(c,function(a,r){if("createdAt"!==r&&e[r]){var c={name:r,v:a};angular.forEach(n,function(n){c[n]=t.length<=n?"--":t[n][r]-t[0][r]}),s.push(c)}}),a.push(i)}),a}s=s("jt.varnishStatsPage");var f=JT_GLOBAL.varnishList,l={},d=this;return d.statsConfig={},d.statsList=null,d.init=!1,d.quotaList=u(),d.start=i,t.$watch("varnishStats.statsConfig.interval",function(){d.statsConfig.status=""}),d};n.$inject=["$scope","$http","$element","$q","$timeout","debug","varnishService"],angular.module("jtApp").controller("VarnishStatsController",n)}(this);