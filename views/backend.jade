extends ./layout

mixin BackendListPingView(backends)
  table.pure-table.pure-table-bordered
    thead: tr
      th #
      th Name
      th Address
      th Port
      th Ping
      th Node
      th OP
      th CreatedAt
    tbody
      each backend, i in backends
        - var node = backend.id;
        tr
          td #{i + 1}
          td #{backend.name}
          td #{backend.ip}
          td #{backend.port}
          td #{backend.ping}
          td #{node}
          td(ng-switch='backendPage.status["#{node}"]')
            span(ng-switch-when='doing') ...
            span.glyphicons.glyphicons-ok-2(ng-switch-when='success')
            a.glyphicons.glyphicons-remove-2(href='javascript:;', ng-click='backendPage.deregister("#{node}")', ng-switch-default)
          td(ng-bind='#{backend.createdAt}| date : "yyyy-MM-dd HH:mm:ss"')
block bodyContainer
  .backendPage(ng-controller='BackendPageController as backendPage')
    //- include ./nav
    //- header.headerContainer
    //-   h3.text-center Backend
    
    .backendSelector.hidden
      - var currentBackendType = viewData.currentBackendType;
      each backendType in viewData.backendTypeList
        - var url = URL('/backend/' + backendType);
        - var itemCssClass = backendType === currentBackendType? "pure-button-primary" : "";
        a.pure-button(href='#{url}', class='#{itemCssClass}') #{backendType}
    .backendList
      if viewData.error
        p.text-center 加载backend信息发生错误
        +Error(viewData.error)
      else if !viewData.backends || !viewData.backends.length
        p.text-center 暂时没有任何backend的信息
      else
        +BackendListPingView(viewData.backends) 
  
  
  - importer.import('/js/backend.js');
  - importer.import('/css/backend.css');
